import React, { useEffect, useMemo, useState } from 'react'
import { AddWidgetButtonButtonProps } from '@procraft/lms-front-redactor/dist/ui/AddWidgetButton/AddWidgetModal/buttons/interfaces'
import { AddWidgetModalButtonStyled } from '@procraft/lms-front-redactor/dist/ui/AddWidgetButton/AddWidgetModal/styles'
import { SvgIcon } from '@procraft/lms-front-redactor/dist/ui/SvgIcon'

/**
 * Добавление виджета курса
 */
export const AddWidgetButtonCourseDev: React.FC<AddWidgetButtonButtonProps> = ({
  closeHandler,
  object,
  addComponent,
  ...other
}) => {
  const buttonState = useState<HTMLButtonElement | null>(null)

  useEffect(() => {
    if (!buttonState[0]) {
      return
    }

    const button = buttonState[0]

    const onClick = () => {
      //

      addComponent({
        name: 'CourseOrderDev',
        component: 'CourseOrderDev',
        props: {},
        components: [],
      })

      closeHandler()
    }

    button.addEventListener('click', onClick)

    return () => {
      button.removeEventListener('click', onClick)
    }
  }, [buttonState, object, closeHandler, addComponent])

  return useMemo(() => {
    return (
      <>
        <AddWidgetModalButtonStyled
          ref={buttonState[1]}
          role="addCourse"
          {...other}
        >
          <SvgIcon>
            <path
              d="M29.8457 61.4248L32.6758 55.0469H33.667L29.8184 63.3799L29.5723 63.8516C29.0892 64.7129 28.3783 65.1436 27.4395 65.1436C27.1615 65.1436 26.9473 65.1185 26.7969 65.0684L26.8721 64.3848C26.9678 64.4167 27.1592 64.4326 27.4463 64.4326C28.0114 64.4326 28.4648 64.1432 28.8066 63.5645L28.9775 63.2568L29.4082 62.3682L25.6416 55.0469H26.6055L29.8457 61.4248ZM40.2227 65H39.4023V61.8896C38.7279 62.1357 38.083 62.2588 37.4678 62.2588C36.488 62.2588 35.777 62.0446 35.335 61.6162C34.8929 61.1833 34.6628 60.5111 34.6445 59.5996V57.6035H35.458V59.5586C35.4671 60.265 35.6221 60.7754 35.9229 61.0898C36.2282 61.3997 36.7432 61.5547 37.4678 61.5547C38.1286 61.5365 38.7734 61.418 39.4023 61.1992V57.6035H40.2227V65ZM45.2744 65.1367C44.6455 65.1367 44.0758 64.9818 43.5654 64.6719C43.0596 64.362 42.6654 63.9313 42.3828 63.3799C42.1003 62.8239 41.959 62.2018 41.959 61.5137V61.2197C41.959 60.5088 42.0957 59.8685 42.3691 59.2988C42.6471 58.7292 43.0322 58.2826 43.5244 57.959C44.0166 57.6309 44.5498 57.4668 45.124 57.4668C46.0218 57.4668 46.7327 57.7744 47.2568 58.3896C47.7855 59.0003 48.0498 59.8366 48.0498 60.8984V61.3564H42.7725V61.5137C42.7725 62.3522 43.0117 63.0518 43.4902 63.6123C43.9733 64.1683 44.5794 64.4463 45.3086 64.4463C45.7461 64.4463 46.1312 64.3665 46.4639 64.207C46.8011 64.0475 47.1064 63.7923 47.3799 63.4414L47.8926 63.8311C47.291 64.7015 46.4183 65.1367 45.2744 65.1367ZM45.124 58.1641C44.5088 58.1641 43.9893 58.3896 43.5654 58.8408C43.1462 59.292 42.891 59.8981 42.7998 60.6592H47.2363V60.5703C47.2135 59.8594 47.0107 59.2806 46.6279 58.834C46.2451 58.3874 45.7438 58.1641 45.124 58.1641ZM52.623 58.0957C53.5618 58.0957 54.3229 58.4033 54.9062 59.0186C55.4896 59.6292 55.7812 60.4404 55.7812 61.4521V61.6299C55.7812 62.2998 55.6468 62.9036 55.3779 63.4414C55.1136 63.9746 54.7308 64.3916 54.2295 64.6924C53.7327 64.9886 53.1608 65.1367 52.5137 65.1367C51.5384 65.1367 50.7477 64.8132 50.1416 64.166C49.54 63.5143 49.2393 62.6462 49.2393 61.5615V60.9053C49.2393 59.374 49.5309 58.1504 50.1143 57.2344C50.6976 56.3184 51.527 55.7715 52.6025 55.5938C53.2816 55.4844 53.7578 55.3363 54.0312 55.1494C54.3092 54.9626 54.4482 54.7074 54.4482 54.3838H55.1523C55.1523 54.7666 55.0726 55.0833 54.9131 55.334C54.7536 55.5846 54.5143 55.7874 54.1953 55.9424C53.8763 56.0928 53.3887 56.2204 52.7324 56.3252C51.9805 56.4437 51.3743 56.765 50.9141 57.2891C50.4583 57.8086 50.1621 58.5059 50.0254 59.3809C50.3171 58.998 50.6816 58.6882 51.1191 58.4512C51.5612 58.2142 52.0625 58.0957 52.623 58.0957ZM50.0596 61.459V61.6299C50.0596 62.4639 50.2852 63.1429 50.7363 63.667C51.1875 64.1865 51.7799 64.4463 52.5137 64.4463C53.252 64.4463 53.8444 64.1842 54.291 63.6602C54.7376 63.1315 54.9609 62.4388 54.9609 61.582V61.4043C54.9609 60.6341 54.7331 60.0052 54.2773 59.5176C53.8262 59.0299 53.2337 58.7861 52.5 58.7861C51.7663 58.7861 51.1761 59.0345 50.7295 59.5312C50.2829 60.0234 50.0596 60.666 50.0596 61.459ZM62.9111 65H62.0908V61.6094H58.1055V65H57.2852V57.6035H58.1055V60.9189H62.0908V57.6035H62.9111V65ZM66.0078 60.29H68.1406C68.6875 60.29 69.166 60.3903 69.5762 60.5908C69.9909 60.7868 70.3031 61.0602 70.5127 61.4111C70.7269 61.762 70.834 62.1699 70.834 62.6348C70.834 63.3503 70.5879 63.9245 70.0957 64.3574C69.6081 64.7858 68.9473 65 68.1133 65H65.1943V57.6035H66.0078V60.29ZM66.0078 60.9873V64.3096H68.127C68.7148 64.3096 69.1751 64.1615 69.5078 63.8652C69.8451 63.569 70.0137 63.1634 70.0137 62.6484C70.0137 62.1562 69.8496 61.7598 69.5215 61.459C69.1979 61.1536 68.7536 60.9964 68.1885 60.9873H66.0078ZM73.3428 65H72.5225V57.6035H73.3428V65ZM80.4795 57.6035H81.2998V65H80.4795V58.9229L76.4873 65H75.6738V57.6035H76.4873V63.6875L80.4795 57.6035ZM80.4385 54.9375C80.4385 55.4616 80.2585 55.8854 79.8984 56.209C79.543 56.5326 79.0645 56.6943 78.4629 56.6943C77.8704 56.6943 77.3919 56.5348 77.0273 56.2158C76.6673 55.8923 76.4873 55.4661 76.4873 54.9375H77.1846C77.1846 55.3158 77.2962 55.6051 77.5195 55.8057C77.7474 56.0062 78.0618 56.1064 78.4629 56.1064C78.8639 56.1064 79.1761 56.0016 79.3994 55.792C79.6273 55.5824 79.7412 55.2975 79.7412 54.9375H80.4385ZM88.9082 61.6094H87.7734V65H86.9463V57.6035H87.7734V60.8848H88.8945L91.6084 57.6035H92.6406L89.6055 61.1924L92.9756 65H91.8955L88.9082 61.6094ZM96.5029 63.8242L98.6631 57.6035H99.5449L96.3867 66.2578L96.2227 66.6406C95.8171 67.5384 95.1904 67.9873 94.3428 67.9873C94.1468 67.9873 93.9372 67.9554 93.7139 67.8916L93.707 67.2148L94.1309 67.2559C94.5319 67.2559 94.8555 67.1556 95.1016 66.9551C95.3522 66.7591 95.5641 66.4196 95.7373 65.9365L96.0996 64.9385L93.3105 57.6035H94.2061L96.5029 63.8242ZM106.764 61.377C106.764 62.5299 106.508 63.446 105.998 64.125C105.488 64.7995 104.804 65.1367 103.947 65.1367C102.936 65.1367 102.161 64.7812 101.623 64.0703V67.8438H100.81V57.6035H101.568L101.609 58.6494C102.143 57.861 102.915 57.4668 103.927 57.4668C104.811 57.4668 105.504 57.8018 106.005 58.4717C106.511 59.1416 106.764 60.0713 106.764 61.2607V61.377ZM105.943 61.2334C105.943 60.29 105.75 59.5449 105.362 58.998C104.975 58.4512 104.435 58.1777 103.742 58.1777C103.241 58.1777 102.81 58.2985 102.45 58.54C102.09 58.7816 101.814 59.1325 101.623 59.5928V63.1406C101.819 63.5645 102.099 63.888 102.464 64.1113C102.828 64.3346 103.259 64.4463 103.756 64.4463C104.444 64.4463 104.979 64.1729 105.362 63.626C105.75 63.0745 105.943 62.277 105.943 61.2334ZM111.316 64.4463C111.886 64.4463 112.362 64.2868 112.745 63.9678C113.132 63.6442 113.342 63.2272 113.374 62.7168H114.16C114.137 63.168 113.996 63.5804 113.736 63.9541C113.477 64.3232 113.13 64.6126 112.697 64.8223C112.269 65.0319 111.809 65.1367 111.316 65.1367C110.346 65.1367 109.576 64.7995 109.006 64.125C108.441 63.4505 108.158 62.5436 108.158 61.4043V61.1582C108.158 60.429 108.286 59.7842 108.541 59.2236C108.796 58.6631 109.161 58.2301 109.635 57.9248C110.113 57.6195 110.672 57.4668 111.31 57.4668C112.121 57.4668 112.788 57.7083 113.312 58.1914C113.841 58.6745 114.124 59.3102 114.16 60.0986H113.374C113.338 59.5199 113.128 59.0527 112.745 58.6973C112.367 58.3418 111.888 58.1641 111.31 58.1641C110.571 58.1641 109.997 58.4307 109.587 58.9639C109.181 59.4971 108.979 60.2445 108.979 61.2061V61.4453C108.979 62.3887 109.181 63.1247 109.587 63.6533C109.997 64.182 110.574 64.4463 111.316 64.4463Z"
              fill="black"
            />
            <path
              d="M90.1043 18.8412L71.0442 12.3229C69.8551 11.8953 70.1052 11.8909 68.9249 12.3185L49.7551 18.7801C48.5748 19.2033 48.5836 19.8927 49.7726 20.3203L54.3271 21.856C52.3087 23.8019 52.1771 25.822 52.1508 28.1649C51.3698 28.4616 50.8169 29.2164 50.8169 30.0977C50.8169 30.9049 51.282 31.6073 51.9621 31.9476C51.6418 34.3298 50.716 37.0524 48 40.2766C49.3426 41.3106 50.0359 41.6553 51.0802 42C54.8799 40.377 54.4148 36.0663 54.1208 31.7775C54.643 31.4023 54.9808 30.7915 54.9808 30.1021C54.9808 29.3647 54.5903 28.7147 54.0024 28.3482C54.0682 26.0532 54.5728 23.9983 56.3015 22.6675C56.3147 22.6326 56.3542 22.6021 56.4288 22.5716L69.5304 17.3054C70.0175 17.1134 70.5703 17.3447 70.7634 17.829L70.7809 17.8726C70.974 18.3569 70.7414 18.9066 70.2544 19.0986L59.1799 23.4965L69.0873 26.8386C70.2763 27.2661 70.0262 27.2705 71.2065 26.8429L90.1219 20.3813C91.2978 19.9581 91.2934 19.2688 90.1043 18.8412ZM69.0609 29.3386L57.065 25.2984V28.3394C57.6924 28.911 58.0391 29.7312 58.0391 30.6388C58.0391 31.459 57.7495 32.2007 57.2668 32.7592C57.4248 33.2347 57.7012 33.7016 58.0961 33.8499C65.0769 37.685 74.7255 37.6457 82.4829 33.4616C83.0577 32.986 83.5052 32.397 83.5052 31.8255V25.1283L71.1846 29.3473C70.0087 29.7705 70.2456 29.7661 69.0609 29.3386Z"
              fill="black"
            />
          </SvgIcon>
        </AddWidgetModalButtonStyled>
      </>
    )
  }, [buttonState, other])
}
