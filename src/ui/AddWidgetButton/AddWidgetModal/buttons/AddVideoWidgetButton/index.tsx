import React, { useEffect, useMemo, useState } from 'react'
import { SvgIcon } from '../../../../SvgIcon'
import { AddWidgetModalButtonStyled } from '../../styles'
import { AddWidgetButtonButtonProps } from '../interfaces'

export const AddVideoWidgetButton: React.FC<AddWidgetButtonButtonProps> = ({
  closeHandler,
  object,
  updateObject,
  ...other
}) => {
  const buttonState = useState<HTMLButtonElement | null>(null)

  useEffect(() => {
    if (!buttonState[0]) {
      return
    }

    const button = buttonState[0]

    const onClick = () => {
      //

      updateObject(object, {
        components: [
          {
            name: 'HtmlTag',
            component: 'HtmlTag',
            props: {
              tag: 'video',
              style: {
                width: '100%',
                maxWidth: '100%',
              },
              controls: true,
            },
            components: [
              // {
              //   name: 'HtmlTag',
              //   component: 'HtmlTag',
              //   props: {
              //     tag: 'source',
              //     src: '',
              //   },
              //   components: [],
              // },
            ],
          },
        ],
      })

      closeHandler()
    }

    button.addEventListener('click', onClick)

    return () => {
      button.removeEventListener('click', onClick)
    }
  }, [buttonState, object, updateObject, closeHandler])

  return useMemo(() => {
    return (
      <>
        <AddWidgetModalButtonStyled ref={buttonState[1]} {...other}>
          <SvgIcon>
            <path d="M51.4746 65V55.0469H54.4141C55.4805 55.0469 56.2894 55.2679 56.8408 55.71C57.3923 56.1475 57.668 56.7946 57.668 57.6514C57.668 58.1663 57.5267 58.6152 57.2441 58.998C56.9661 59.3763 56.5833 59.6475 56.0957 59.8115C56.6745 59.9391 57.1393 60.224 57.4902 60.666C57.8457 61.1081 58.0234 61.6185 58.0234 62.1973C58.0234 63.0768 57.7386 63.765 57.1689 64.2617C56.6038 64.7539 55.8154 65 54.8037 65H51.4746ZM52.3154 60.2148V64.2891H54.8379C55.5579 64.2891 56.1276 64.1068 56.5469 63.7422C56.9707 63.373 57.1826 62.8626 57.1826 62.2109C57.1826 61.5957 56.9798 61.1104 56.5742 60.7549C56.1732 60.3949 55.6172 60.2148 54.9062 60.2148H52.3154ZM52.3154 59.5107H54.6123C55.3141 59.4971 55.8564 59.333 56.2393 59.0186C56.6266 58.6995 56.8203 58.237 56.8203 57.6309C56.8203 56.9928 56.6198 56.5234 56.2188 56.2227C55.8223 55.9173 55.2207 55.7646 54.4141 55.7646H52.3154V59.5107ZM64.7295 57.6035H65.5498V65H64.7295V58.9229L60.7373 65H59.9238V57.6035H60.7373V63.6875L64.7295 57.6035ZM67.5732 64.3096L67.9355 63.8379C68.5098 63.0586 68.8402 61.9193 68.9268 60.4199L69.0566 57.6035H73.4248V64.3096H74.1904V67.1738H73.377V65H67.8193V67.1738H67.0332L67.04 64.3096H67.5732ZM68.5166 64.3096H72.6045V58.3691H69.8359L69.7471 60.29C69.665 62.0537 69.2549 63.3936 68.5166 64.3096ZM78.6338 65.1367C78.0049 65.1367 77.4352 64.9818 76.9248 64.6719C76.4189 64.362 76.0247 63.9313 75.7422 63.3799C75.4596 62.8239 75.3184 62.2018 75.3184 61.5137V61.2197C75.3184 60.5088 75.4551 59.8685 75.7285 59.2988C76.0065 58.7292 76.3916 58.2826 76.8838 57.959C77.376 57.6309 77.9092 57.4668 78.4834 57.4668C79.3812 57.4668 80.0921 57.7744 80.6162 58.3896C81.1449 59.0003 81.4092 59.8366 81.4092 60.8984V61.3564H76.1318V61.5137C76.1318 62.3522 76.3711 63.0518 76.8496 63.6123C77.3327 64.1683 77.9388 64.4463 78.668 64.4463C79.1055 64.4463 79.4906 64.3665 79.8232 64.207C80.1605 64.0475 80.4658 63.7923 80.7393 63.4414L81.252 63.8311C80.6504 64.7015 79.7777 65.1367 78.6338 65.1367ZM78.4834 58.1641C77.8682 58.1641 77.3486 58.3896 76.9248 58.8408C76.5055 59.292 76.2503 59.8981 76.1592 60.6592H80.5957V60.5703C80.5729 59.8594 80.3701 59.2806 79.9873 58.834C79.6045 58.3874 79.1032 58.1641 78.4834 58.1641ZM82.5508 61.1924C82.5508 60.4814 82.6875 59.8411 82.9609 59.2715C83.2389 58.7018 83.6286 58.2598 84.1299 57.9453C84.6357 57.6263 85.2077 57.4668 85.8457 57.4668C86.8301 57.4668 87.6276 57.8132 88.2383 58.5059C88.849 59.194 89.1543 60.1077 89.1543 61.2471V61.418C89.1543 62.1335 89.0153 62.7783 88.7373 63.3525C88.4639 63.9222 88.0765 64.362 87.5752 64.6719C87.0739 64.9818 86.502 65.1367 85.8594 65.1367C84.8796 65.1367 84.082 64.7926 83.4668 64.1045C82.8561 63.4118 82.5508 62.4958 82.5508 61.3564V61.1924ZM83.3711 61.418C83.3711 62.3021 83.599 63.029 84.0547 63.5986C84.515 64.1637 85.1165 64.4463 85.8594 64.4463C86.5977 64.4463 87.1947 64.1637 87.6504 63.5986C88.1107 63.029 88.3408 62.2793 88.3408 61.3496V61.1924C88.3408 60.6273 88.236 60.11 88.0264 59.6406C87.8167 59.1712 87.5228 58.8089 87.1445 58.5537C86.7663 58.2939 86.3333 58.1641 85.8457 58.1641C85.1165 58.1641 84.5218 58.4512 84.0615 59.0254C83.6012 59.5951 83.3711 60.3424 83.3711 61.2676V61.418Z" fill="black" />
            <rect x="36.5" y="8.5" width="68" height="36" rx="2.5" stroke="black" />
            <path d="M64.25 18.1794L82.7794 26.5L64.25 34.8206L64.25 18.1794Z" fill="black" stroke="black" />
            <line x1="94.5" y1="9" x2="94.5" y2="45" stroke="black" strokeDasharray="6 6" />
            <line x1="46.5" y1="9" x2="46.5" y2="45" stroke="black" strokeDasharray="6 6" />
          </SvgIcon>
        </AddWidgetModalButtonStyled>
      </>
    )
  }, [buttonState, other])
}
